/**
 * PostMessenger
 * Copyright (c) 2015 Patrick Fox
 * https://github.com/Taeon/PostMessenger for licence and docs
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.PostMessenger=t()}(this,function(){function e(e,t,n){var a;this.l=[],this.d=void 0===(a=e)||null==a?window.location.protocol+"//"+window.location.host:a,this.e=function(e){var t;if(e==parent)t=[e];else switch(Object.prototype.toString.call(e).match(/\[object (.*)\]/)[1]){case"Window":case"HTMLIFrameElement":case"global":t=[e];break;case"Object":t="undefined"!=typeof jQuery&&e instanceof jQuery?e.toArray():[e];break;case"String":t=document.querySelectorAll(e)}return t||e}(t),this.n=n;var i=window.addEventListener?"addEventListener":"attachEvent",o=this;window[i]("attachEvent"==i?"onmessage":"message",function(){(function(e){var t=e.data;if("string"==typeof t)try{t=JSON.parse(e.data)}catch(i){return}for(var n=0;n<this.l.length;n++){var a=this.l[n];if(!(null!=a.domain&&"*"!=a.domain&&a.domain.match(/^(?:.*)\/\/(.+)(?:\/|$)/)[1]!=e.origin.match(/^(?:.*)\/\/(.+)(?:\/|$)/)[1]||null!=a.namespace&&a.namespace!=t.namespace||this.n&&this.n!=t.namespace))if(a.element_selector)for(var i=0;i<this.e.length;i++){var o=this.e[i];try{"IFRAME"==o.nodeName&&(o=o.contentWindow)}catch(i){}o==e.source&&a.func(t.data,e)}else a.func(t.data,e)}}).apply(o,arguments)},!1)}return e.prototype.Send=function(e,t){for(var n=0;n<this.e.length;n++)element=this.e[n],element!=parent&&"IFRAME"==element.nodeName&&(element=element.contentWindow),void 0!==this.n&&(t=this.n),element.postMessage(JSON.stringify({namespace:t,data:e}),this.d)},e.prototype.AddListener=function(e,t){var n=(new Date).getTime().toString()+Math.random();return this.l.push({id:n,func:e,domain:this.d,namespace:t,element_selector:this.e}),n},e.prototype.RemoveListener=function(e){for(var t=0;t<this.l.length;t++)if(this.l[t].id==e){this.l.splice(t,1);break}},e});
